<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Server-side Differential Expression Analysis using edgeR — ds.edgeR • dsOmicsClient</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Server-side Differential Expression Analysis using edgeR — ds.edgeR"><meta property="og:description" content="This function performs a non-disclosive
Differential Expression Analysis using edgeR package functions
from Bioconductor."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dsOmicsClient</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/geno_exploration.html">OmicSHIELD bookdown</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Server-side Differential Expression Analysis using edgeR</h1>
    
    <div class="hidden name"><code>ds.edgeR.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function performs a non-disclosive
Differential Expression Analysis using <code>edgeR</code> package functions
from Bioconductor.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">ds.edgeR</span><span class="op">(</span>
  <span class="va">model</span>,
  <span class="va">set</span>,
  test <span class="op">=</span> <span class="st">"QLF"</span>,
  dispersion <span class="op">=</span> <span class="st">"both"</span>,
  normalization <span class="op">=</span> <span class="st">"TMM"</span>,
  levels <span class="op">=</span> <span class="st">"design"</span>,
  coef <span class="op">=</span> <span class="fl">2</span>,
  contrast <span class="op">=</span> <span class="cn">NULL</span>,
  datasources <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>model</dt>
<dd><p>formula indicating the condition and other covariates to be adjusted.</p></dd>
<dt>set</dt>
<dd><p><code>SummarizedExperiment</code> object.</p></dd>
<dt>test</dt>
<dd><p>a character string specifying the test to carry out. 
<code>test</code> parameter can be set as <code>"QLF"</code> or <code>LRT</code>. Default <code>"QLF"</code>. 
For more information see <strong>Details</strong>.</p></dd>
<dt>dispersion</dt>
<dd><p>a character string specifying the type of dispersion to estimate. 
This can be set as <code>both</code>, <code>common</code> or <code>tagwise</code>. 
For more information see <strong>Details</strong>. Default <code>"both"</code>.</p></dd>
<dt>normalization</dt>
<dd><p>a character string specifying the normalization method to be used. 
This can be set as <code>"TMM"</code>,<code>"TMMwsp"</code>,<code>"RLE"</code>,<code>"upperquartile"</code> or 
<code>"none"</code>. Default <code>"TMM"</code>. For more information see <strong>Details</strong>.</p></dd>
<dt>levels</dt>
<dd><p>a character or factor vector specifying the names of the parameters to be
used in <code>contrast</code>. Also, the design matrix can be specified. Default <code>"design"</code>.</p></dd>
<dt>coef</dt>
<dd><p>an integer or character specifying the coefficients of the linear model
to be tested equal to zero. Default <code>2</code>.</p></dd>
<dt>contrast</dt>
<dd><p>the comparison to extract from the object to build the results table.</p></dd>
<dt>datasources</dt>
<dd><p>a list of <code><a href="https://datashield.github.io/DSI/reference/DSConnection-class.html" class="external-link">DSConnection-class</a></code> objects obtained after login. 
If the <code>datasources</code> argument is not specified
the default set of connections will be used: see <code><a href="https://datashield.github.io/DSI/reference/datashield.connections_default.html" class="external-link">datashield.connections_default</a></code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>ds.edgeR</code> returns to the client-side a data frame containing differential expression
results for the top genes sorted by adjusted p-value.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Differential Expression Analysis of RNA-seq data based on  
genewise negative binomial generalized linear models using either 
likelihood ratio or quasi-likelihood F-tests.</p>
<p>The steps implemented by DataSHIELD <code>ds.edgeR</code>  
client-side and <code>edgeRDS</code> server-side function is the following:<br>
(1) Create <code>DGEList</code> object<br>
(2) Filter genes using Expression Level. Implemented by <code>filterByExpr</code>
function from <code>edgeR</code> package.<br>
(3) Calculate the Normalization Factors using <code>calcNormFactors</code> function.
The <code>normalization</code> parameter can be set as follows:</p><ul><li><p><code>"TMM"</code>: uses a trimmed mean of M-values between each pair of samples.</p></li>
<li><p><code>"TMMwsp"</code>: TMM with singleton pairing.
   A variant of <code>TMM</code> that performs better  with a high proportion of zeros data</p></li>
<li><p><code>"RLE"</code>: relative log expression. 
   The median library is calculated from the geometric mean of all columns 
   and the median ratio of each sample to the median library is taken as the scale factor.</p></li>
<li><p><code>"upperquartile"</code>: the scale factors are calculated from the 75% quantile of the 
   counts for each library, after removing genes that are zero in all libraries.</p></li>
<li><p><code>"none"</code>: the normalization factors are set to 1.</p></li>
</ul><p>Note that normalization is only necessary for sample-specific effects.<br>
(4) Estimate the dispersion. 
The <code>dispersion</code> parameter can be set as follows:<br></p><ul><li><p><code>"both"</code>: estimate common and tagwise dispersions in one run (<code>estimateDisp</code>).</p></li>
<li><p><code>"common"</code>: estimate common dispersion (<code>estimateCommonDisp</code>).</p></li>
<li><p><code>"tagwise"</code>: estimate tagwise dispersions (<code>estimateTagwiseDisp</code>). 
    Note that before needs to 
    estimate common dispersion. This is done automatically  when <code>tagwise</code> option
    is selected.</p></li>
</ul><p>(5) Differential Expression Analysis. <code>test</code> can be set as follows:</p><ul><li><p><code>"QLF"</code>: perform quasi-likelihood F-tests (<code>glmQLFit</code> and <code>glmQLFTest</code>).
      Highly recommended for differential expression analysis of RNA-seq.</p></li>
<li><p><code>"LRT"</code>: perform likelihood ratio tests (<code>glmFit</code> and <code>glmLRT</code>).
      Useful in single cell RNA-seq and datasets with no replicates.</p></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>L. Abarrategui, for DataSHIELD development team</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"> </span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"> <span class="co">#required packages</span></span>
<span class="r-in"></span>
<span class="r-in"> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/datashield/DSI/" class="external-link">DSI</a></span><span class="op">)</span></span>
<span class="r-in"> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/datashield/DSOpal/" class="external-link">DSOpal</a></span><span class="op">)</span></span>
<span class="r-in"> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">dsBaseClient</span><span class="op">)</span></span>
<span class="r-in"> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">dsOmicsClient</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"> <span class="co"># Connecting to the Opal servers</span></span>
<span class="r-in"> <span class="va">builder</span> <span class="op">&lt;-</span> <span class="fu">DSI</span><span class="fu">::</span><span class="fu"><a href="https://datashield.github.io/DSI/reference/newDSLoginBuilder.html" class="external-link">newDSLoginBuilder</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"> <span class="va">builder</span><span class="op">$</span><span class="fu">append</span><span class="op">(</span>server <span class="op">=</span> <span class="st">"study1"</span>, url <span class="op">=</span> <span class="st">"https://opal-demo.obiba.org/"</span>, </span>
<span class="r-in">                user <span class="op">=</span> <span class="st">"dsuser"</span>, password <span class="op">=</span> <span class="st">"password"</span>, </span>
<span class="r-in">                resource <span class="op">=</span> <span class="st">"RSRC.tcga_liver"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"> <span class="va">logindata</span> <span class="op">&lt;-</span> <span class="va">builder</span><span class="op">$</span><span class="fu">build</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"> <span class="va">conns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://datashield.github.io/DSI/reference/datashield.login.html" class="external-link">datashield.login</a></span><span class="op">(</span>logins <span class="op">=</span> <span class="va">logindata</span>, </span>
<span class="r-in">                           assign <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span class="r-in">                           symbol <span class="op">=</span> <span class="st">"res"</span><span class="op">)</span></span>
<span class="r-in">                           </span>
<span class="r-in"> <span class="co">#coerce the resource to a RangedSummarizedExperiment</span></span>
<span class="r-in"></span>
<span class="r-in"> <span class="fu"><a href="https://datashield.github.io/DSI/reference/datashield.assign.expr.html" class="external-link">datashield.assign.expr</a></span><span class="op">(</span>conns <span class="op">=</span> <span class="va">conns</span>, </span>
<span class="r-in">                        symbol <span class="op">=</span> <span class="st">"rse"</span>,</span>
<span class="r-in">                        expr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="fu">as.resource.object</span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">                        </span>
<span class="r-in"> <span class="co">#Differential Expression analysis</span></span>
<span class="r-in"> </span>
<span class="r-in"> <span class="co">##Default settings</span></span>
<span class="r-in"> <span class="fu">ds.edgeR</span><span class="op">(</span>model <span class="op">=</span><span class="op">~</span> <span class="va">gdc_cases.demographic.gender</span>,set <span class="op">=</span> <span class="st">"rse"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"> <span class="co"># Clear the Datashield R sessions and logout  </span></span>
<span class="r-in">  </span>
<span class="r-in">  <span class="fu">DSI</span><span class="fu">::</span><span class="fu"><a href="https://datashield.github.io/DSI/reference/datashield.logout.html" class="external-link">datashield.logout</a></span><span class="op">(</span><span class="va">conns</span><span class="op">)</span> </span>
<span class="r-in">  <span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yannick Marcon, Xavier Esriba-Montagut, Juan R. Gonzalez.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

